<?php
$title = $date = $entry = $tags = '';

$id = filter_input(INPUT_GET, 'id', FILTER_SANITIZE_NUMBER_INT);
$item = $post->getPost($id);

$section = "Edit Entry";

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $id = filter_input(INPUT_POST, 'post_id', FILTER_SANITIZE_NUMBER_INT);
    $title = trim(filter_input(INPUT_POST, 'title', FILTER_SANITIZE_STRING));
    $date = trim(filter_input(INPUT_POST, 'date', FILTER_SANITIZE_STRING));
    $entry = trim(filter_input(INPUT_POST, 'entry', FILTER_SANITIZE_STRING));
    $tags = trim(filter_input(INPUT_POST, 'tags', FILTER_SANITIZE_STRING));

    if ($post->updatePost($title, $date, $entry, $tags, $id)) {
        echo 'Successfully edited entry.';
        header('refresh: 1; url = entries/' . implode('-', explode(' ', $item[0]['title'])) . '?id=' . $item[0]['post_id'] . '');
    } else {
        echo 'Unable to edit entry. Try again.';
    }
}

include __DIR__ . '/header.phtml';
?>
         <section>
             <div class="container">
                <div class="edit-entry">
                    <h2>Edit Entry</h2>
                    <form method="post" action="/edit?id=<?php echo $id; ?>">
                        <label for="title">Title</label>
                        <input type="text" name="title" value="<?php echo $item[0]['title']; ?>"><br>
                        <label for="date">Date</label>
                        <input type="datetime-local" name="date" value="<?php echo $item[0]['date']; ?>"><br>
                        <label for="entry">Entry</label>
                        <textarea rows="5" name="entry"><?php echo $item[0]['body']; ?></textarea>
                        <label for="tags">Tags (separate with commas)</label>
                        <textarea rows="2" name="tags"><?php echo $item[0]['tags']; ?></textarea>
                        <input type="hidden" name="post_id" value="<?php echo $id; ?>">
                        <input type="submit" value="Save Entry" class="button">
                        <a href="index.pthml" class="button button-secondary">Cancel</a>
                    </form>
                </div>
            </div>
        </section>
<?php include __DIR__ . '/footer.phtml'; ?>
